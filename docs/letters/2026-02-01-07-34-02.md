# 申し送り（2026-02-01 07:34:02）

> **⚠️ 機密情報保護ルール**
>
> この申し送りに記載する情報について:
> - API キー・パスワード・トークンは必ずプレースホルダー(`YOUR_API_KEY`等)で記載
> - 実際の機密情報は絶対に含めない
> - .env や設定ファイルの内容をそのまま転記しない
> - コミット前に git diff で内容を確認
> - プッシュはせずコミットのみ(人間がレビュー後にプッシュ)

## 🔔 Compact前チェックリスト

### トークン使用量の目安
トークン予算の**75-85%**を超えたら申し送り作成を検討しましょう。

- **75%超**: 余裕を持って検討開始
- **85%超**: 早急に申し送り作成
- **100%**: auto compactが発火（文脈が失われる前に記録を！）

> 💡 **トークン使用量の確認方法**
> 会話中に表示される `Token usage: X/Y; Z remaining` を参照
> 例: Claude Codeの場合は予算200,000トークン

### 記録すべき内容を確認
- [x] 現在のセッションで決定した重要事項を記録したか？
- [x] 議論の流れと理由を記録したか？
- [x] 次のセッションで必要な「文脈」「空気感」を言語化したか？
- [x] 技術的な決定の「なぜ」を明記したか？
- [x] 注意事項に新しい学びを追加したか？

---

## 🔍 次のセッション開始時の検証プロトコル

**次のAIへ: セッション開始時に必ず以下を実行してください**

### 1. 前セッションの完了状態を検証
下記の「検証コマンド」を実行し、申し送りの「完了」が実態と一致しているか確認してください。

### 2. 検証結果を人間に報告
- ✅ **全て成功**: 「前セッションの完了状態を確認しました。次は Phase 2 実装から開始します。」
- ⚠️ **失敗あり**: 該当なし（今回は構想・微調整のみで実装なし）

### 3. 実態ベースで進める
- 申し送りの「完了」は参考程度
- 検証結果が真実

---

## 🔧 コマンド実行ルール

**次のAIへ: コマンド実行前に必ず確認すること**

### 原則：プロジェクトの標準実行方法を探す
実行前に以下を**順番に確認**してから判断：

1. **package.json** の `scripts` セクション（Node.js系）
2. **Makefile** の targets（`make dev`, `make start` など）
3. **docker-compose.yml** の存在（Docker系）
4. **README.md** の Getting Started / Development セクション
5. **pyproject.toml** / **Cargo.toml** など（他言語）

### 禁止事項
- ❌ 確認なしで勝手にサーバー起動
- ❌ `node src/index.js` のような直接実行（scriptsがある場合）
- ❌ ビルド・DB操作を無断実行

### 推奨手順
```bash
# このプロジェクトは静的なパターン集なので、起動・停止の概念なし
# 必要に応じて degit でテンプレートを配布
```

**理由**: プロジェクトごとに標準的な起動方法が異なるため

---

## 現在の状況

### ✅ 完了: docs-structure v1.1.0 微調整と Phase 3 構想完成

**ステータス**: ✅ 完了

**完了内容**:

- ✅ **バージョン管理の導入**
  - `patterns/docs-structure/VERSION` ファイル作成（v1.0.1）
  - 散らばらない一元管理

- ✅ **Phase 3 ワンショット構想の策定**
  - `docs/notes/0028_docs-structure-v1.0.1-to-v1.1.0-migration-oneshot-design.md` 作成
  - migration/ ディレクトリ構成の設計
  - MIGRATION_GUIDE_v1.0.1_to_v1.1.0.md の完全な仕様
  - 汎用的（どのリポジトリでも使える）

- ✅ **GitHub URL 修正**
  - 全パターンで `tree/main` を削除
  - degit が正常動作するように

- ✅ **コミット時の AI 署名判定ロジック改善**
  - `gh` コマンド依存を排除
  - `git log` で従来のスタイルを把握
  - ユーザーに直接確認する方式に

- ✅ **action 指示書の理解チェック機構追加**
  - 主要4つの action に追加
  - AI が何をするか事前に提示
  - ユーザーがゴーサインを出してから実行

- ✅ **既存更新セクションの追加・改善（差分確認型）**
  - actions-pattern: 既存セクションを改善
  - docs-structure: 新規セクションを追加
  - 差分を見て理解してから更新できる仕組み

- ✅ **ノート作成とコミット**
  - `docs/notes/0029_docs-structure-v1.1.0-fine-tuning-improvements.md` 作成
  - 4つのコミット完了（プッシュなし）

**未完了内容**:
- なし（今回は構想・微調整のみ、Phase 2 実装は次回）

**検証コマンド** (次のセッションのAIが実行):
```bash
# VERSION ファイルが存在することを確認
cat patterns/docs-structure/VERSION

# Phase 3 構想ノートが存在することを確認
ls docs/notes/0028_docs-structure-v1.0.1-to-v1.1.0-migration-oneshot-design.md

# 微調整ノートが存在することを確認
ls docs/notes/0029_docs-structure-v1.1.0-fine-tuning-improvements.md

# Git コミットを確認
git log --oneline -4
```

**検証が失敗した場合の対処**:
- ファイルが見つからない場合 → 申し送りを再確認

---

## 次にやること

1. **最優先: Phase 2 実装（新規稼働用テンプレート更新）**
   - 理由: 改修計画が完成し、実装準備が整った
   - 対象: 12ファイル
   - 参照: `docs/notes/0027_docs-structure-v1.0.1-to-v1.1.0-refactoring-plan.md`

2. **次に: Phase 3（既存ファイル移行）**
   - 理由: Phase 2 完成後に実施
   - 対象: docs/notes/ (26ファイル), docs/letters/ (6ファイル)
   - 参照: `docs/notes/0028_docs-structure-v1.0.1-to-v1.1.0-migration-oneshot-design.md`

3. **その後: Phase 4（派生パターンへの波及）**
   - 理由: Phase 2/3 完成後に実施
   - 対象: docs-structure-for-target-branch-only, writing-collaborate, actions-pattern

## 注意事項

- ⚠️ **Phase 2 実装は慎重に**: 12ファイル更新なので、1つずつ確認しながら進める
- ⚠️ **AI 勘違い対策が重要**: HTML コメント + セパレーターの構造を正確に
- ⚠️ **FrontMatter は tags のみ**: created を入れないこと（ファイル名と重複）
- ⚠️ **README は3-5行のみ**: 情報は TEMPLATE に集約
- ⚠️ **理解チェック機構**: 主要4つの action に追加済み、他の action は必要に応じて追加

## 技術的な文脈

- **プロジェクト**: my-ai-collaboration-patterns
- **リポジトリタイプ**: 公開リポジトリ（Claude痕跡なし）
- **対象パターン**: docs-structure (v1.0.1 → v1.1.0)
- **重要ファイル**:
  - `patterns/docs-structure/VERSION` (v1.0.1)
  - `docs/notes/0027_docs-structure-v1.0.1-to-v1.1.0-refactoring-plan.md` (Phase 2 詳細)
  - `docs/notes/0028_docs-structure-v1.0.1-to-v1.1.0-migration-oneshot-design.md` (Phase 3 詳細)
  - `docs/notes/0029_docs-structure-v1.1.0-fine-tuning-improvements.md` (今回の微調整)
  - `patterns/docs-structure/templates/` (改修対象のテンプレート群)

---

## セッション文脈サマリー

### 核心的な設計決定

**決定事項1: バージョン管理は VERSION ファイル一元化**
- 理由: 散らばらない、明確、migration/ で活用可能
- 影響範囲: patterns/docs-structure/VERSION

**決定事項2: Phase 3 は独立ノート化**
- 理由: Phase 2 と混在すると分かりにくい、ワンショット指示として独立性が必要
- 影響範囲: docs/notes/0028

**決定事項3: コミット判定は git log ベース**
- 理由: gh 依存を排除、従来のスタイルを参考にすることで一貫性向上
- 影響範囲: actions/git_commit.md, actions/00_session_end.md

**決定事項4: 理解チェック機構の導入**
- 理由: AI が何をするか事前に提示、ユーザーがゴーサインを出してから実行
- 影響範囲: 主要4つの action

**決定事項5: 既存更新は差分確認型**
- 理由: 事故防止、理解促進、カスタマイズ保護
- 影響範囲: actions-pattern, docs-structure の README

### 議論の流れ

1. **最初の問題認識**: Phase 3 構想を 0027 に追記したが、ワンショット指示として分離すべき
2. **検討したアプローチ**:
   - 統合 vs 分離 → 分離に決定
   - バージョン管理: 散らばる vs 一元化 → VERSION ファイルに決定
   - コミット判定: gh vs git log → git log に決定
   - 更新方式: 完全上書き vs 差分確認 → 差分確認に決定
3. **最終決定**: 6つの微調整を実施
4. **残った課題**: Phase 2 実装、Phase 3 実装、Phase 4 波及

### 次のセッションに引き継ぐべき「空気感」

**このプロジェクトの優先順位**:
- **トークン削減**が最優先（64%削減を目指す）
- **スケーラビリティ**（250/1000ノート時代への備え）
- **複数人運用**への親和性
- **事故防止**（差分確認、理解チェック）

**避けるべきアンチパターン**:
- 情報の二重管理（README と TEMPLATE に同じ内容を書く）
- 過度な FrontMatter（created は不要、tags のみ）
- AI の勘違いを招く構造（HTML コメント + セパレーターで対策）
- gh コマンドへの依存（環境によって入っていない）

**重視している価値観**:
- **シンプルさの維持**: 「言語化の極致」に忠実
- **AI 協働開発の最適化**: AI が読みやすい構造
- **ドッグフーディング**: 自分たちが使い込んで効果を検証
- **差分確認型の更新**: 何が変わるか理解してから実行

**現在の開発フェーズ**:
- **構想完成 → 実装準備完了**
- Phase 2 実装が次のステップ
- 慎重に、1ファイルずつ確認しながら進める

---

**作成日時**: 2026-02-01 07:34:02
**作成者**: Claude Sonnet 4.5
