# パターン構造の設計 - 開発記録

**作成日**: 2025-10-23
**関連タスク**: リポジトリ初期構築

## 問題

パターンリポジトリをどう構造化すべきか。

### 背景
- ワンショット指示でAIに構造を作らせてきた
- 毎回同じ指示を繰り返すのは非効率
- 再利用可能なパターンとして保存したい

### 課題
1. ワンショット指示とファイル構造の関係は？
2. GUIDE.md は何のため？
3. templates/ には何を配置すべきか？

## 試行錯誤

### アプローチA: テンプレートだけ配置
**試したこと**: templates/ にファイル構造だけ配置

**結果**: 不十分

**理由**:
- なぜこの構造なのか分からない
- カスタマイズできない
- 学習・理解ができない

---

### アプローチB: GUIDE.md でワンショット指示を記録
**試したこと**:
- templates/ に完成品を配置
- GUIDE.md にそれを作ったワンショット指示を記録

**結果**: 成功

**理由**:
- **再現性**: 同じ指示で別バージョンを作れる
- **カスタマイズ性**: 指示を修正して自分用に調整できる
- **理解**: なぜこの構造なのか理解できる

## 解決策

### パターンの推奨構造

```
patterns/your-pattern/
├── README.md          # パターン説明（概要・使い方）
├── GUIDE.md           # ⭐ ワンショット指示（このテンプレートの作り方）
├── core/              # 詳細ドキュメント（オプション）
├── templates/         # 💎 完成品（degit でコピー）
│   └── [実際のファイル]
└── examples/          # 使用例（オプション）
```

### GUIDE.md の役割

**目的**: このテンプレートを作成したワンショット指示を記録

**メリット**:
1. **作成記録**: どういう指示で作ったか明確
2. **再現性**: 同じ指示で別バージョンを作れる
3. **カスタマイズ**: 指示を修正して自分用に調整
4. **学習**: AIと開発者の両方が理解できる

**例**:
```markdown
# ドキュメント構造パターン - GUIDE

このテンプレートは以下のワンショット指示で作成しました：

---

「AIと協働開発するためのドキュメント管理構造を作ってください。

要件：
- セッション間で文脈を引き継げる申し送り機能
- 技術調査を蓄積する開発ノート
- 重要な意思決定を記録するADR
- README駆動のナビゲーション

構造：
docs/
├── README.md
├── letter/（申し送り）
├── notes/（開発ノート）
└── architecture/decisions/（ADR）
」

---

## カスタマイズ例

letter/ を handoff/ に変更したい場合：
[指示の修正方法]
```

### templates/ の配置方針

**配置するもの**:
- ✅ ユーザーがコピーして使うファイル
- ✅ すぐに使える状態の完成品
- ✅ README、TEMPLATE、サンプル

**配置しないもの**:
- ❌ パターンの説明（README.md に書く）
- ❌ 作り方の説明（GUIDE.md に書く）
- ❌ 詳細ドキュメント（core/ に書く）

## 実装例

### パターン1: docs-structure（今後作成予定）

```
patterns/docs-structure/
├── README.md              # 「ドキュメント構造パターン」の説明
├── GUIDE.md               # AI協働開発ガイドを読んで作った
├── templates/             # degit で配布
│   └── docs/
│       ├── README.md
│       ├── letter/
│       └── notes/
└── examples/
    └── sample-project/
```

### パターン2: server-management（バリエーション付き）

```
patterns/server-management/
├── README.md
├── core/                  # Native/Docker 共通知識
└── variants/
    ├── native/
    │   ├── README.md
    │   ├── GUIDE.md       # Native版の作り方
    │   └── templates/
    └── docker/
        ├── README.md
        ├── GUIDE.md       # Docker版の作り方
        └── templates/
```

## 学び

### 1. ワンショット指示とファイル構造は両方必要
- **指示**: 柔軟性・カスタマイズ性
- **ファイル**: 即座に使える・学習コスト低い

### 2. GUIDE.md の価値
- 単なる説明ではなく「作り方のレシピ」
- AIと人間の両方が理解できる
- 再現性とカスタマイズ性を両立

### 3. 汎用性と具体性のバランス
- templates/ は具体的（すぐ使える）
- GUIDE.md は汎用的（カスタマイズ可能）
- このバランスが重要

## 今後の改善案

1. **実例の作成**: patterns/docs-structure/ を実際に作る
2. **GUIDE.md のテンプレート**: パターン作成者向けガイド
3. **バリエーション管理**: variants/ の使い方を明確化

## 関連ドキュメント

- [degit の挙動理解](./01_degit-understanding.md)
- [ドッグフーディング実践](./03_repository-dogfooding.md)
- [AI協働開発ガイド](../ai-collaboration/AI_COLLABORATION_GUIDE.md)

---

**最終更新**: 2025-10-23
**作成者**: Claude Code + User
