---
tags: [actions-pattern, development, quality, refactoring, testing]
---

# 開発品質系アクションの作成

**作成日**: 2026-01-21
**カテゴリ**: アクション設計
**ステータス**: 実験的

## 問題

開発中に繰り返す品質関連の指示（レビュー、リファクタリング、セキュリティチェック、テスト作成）を毎回説明するのは非効率。

### 背景

- コードレビューを依頼するたびに「全体を俯瞰して」「指摘リストを出して」と説明
- リファクタリング時に「機能は変えないで」「テストを通して」と毎回注意
- セキュリティチェックの観点を毎回列挙
- テスト作成の方針を毎回説明

## 解決策

4つの開発系アクションファイルを作成：

1. **dev_review.md**：全体レビュー
2. **dev_refactoring.md**：リファクタリング
3. **dev_security.md**：セキュリティチェック
4. **dev_testing.md**：テスト作成

## 設計上の決定

### 決定1: 診断と治療の分離

- **レビューは「指摘のみ」で停止**
  - 理由: 指摘リストを notes に記録し、人間が優先順位を判断したい
  - AIが勝手にリファクタリングを開始しないよう明記

- **リファクタリングは「修正を実行」**
  - 理由: 指定範囲を明確にして、局所的に改善する
  - 機能変更との境界を明確にする

### 決定2: 最小限の有形物

- **テストファイル以外は既存コードに作用**
  - 理由: 新しいファイルを増やさない方針
  - テストは「リファクタのガードレール」として必要なため許容

### 決定3: ツール非依存の記述

- **特定のツール名（Bash, Read等）を使わない**
  - 理由: Claude Code、Cursor、Windsurf など複数ツールで利用可能にする
  - 自然言語で「やること」「やらないこと」を記述

### 決定4: 観点の明示

各アクションに「観点」セクションを追加：
- dev_review.md: 粒度、共通化、責務、命名、不要コード
- dev_refactoring.md: 重複、分割、命名、削除、責務
- dev_security.md: シークレット、入力検証、DB、認証・認可
- dev_testing.md: 優先順位（ユーティリティ → ビジネスロジック → API → 複雑な分岐）

## ファイル構成

```
docs/actions/
├── dev_review.md         # 全体レビュー（診断）
├── dev_refactoring.md    # リファクタリング（治療）
├── dev_security.md       # セキュリティチェック
└── dev_testing.md        # テスト作成（ガードレール）
```

## 使用例（想定）

### パターンA: 開発中の局所改善

```
開発中
  → 気になる箇所がある
  → @actions/dev_refactoring.md で局所改善
```

### パターンB: 一区切り後の全体チェック

```
一区切り
  → @actions/dev_testing.md でガードレール作成
  → @actions/dev_refactoring.md で安心してリファクタ
  → @actions/dev_review.md で全体確認
  → @actions/dev_security.md で公開前チェック
  → notes に経緯を残す
```

## 今後の検証

実際に使用してフィードバックを収集：
- ワンショットで期待通りに動作するか
- 「やらないこと」が守られるか
- 観点が適切か（不足・過剰がないか）
- 出力形式が使いやすいか

## 関連ノート

- [0022_actions-pattern-refinement.md](0022_actions-pattern-refinement.md) - actions パターンのリファクタリング
- [0023_actions-pattern-sync-workflow.md](0023_actions-pattern-sync-workflow.md) - actions-pattern 同期ワークフロー
