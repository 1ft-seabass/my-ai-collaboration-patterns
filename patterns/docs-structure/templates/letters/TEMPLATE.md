# 申し送り（YYYY-MM-DD HH:MM:SS）

## 🔔 Compact前チェックリスト

### トークン使用量の目安
トークン予算の**75-85%**を超えたら申し送り作成を検討しましょう。

- **75%超**: 余裕を持って検討開始
- **85%超**: 早急に申し送り作成
- **100%**: auto compactが発火（文脈が失われる前に記録を！）

> 💡 **トークン使用量の確認方法**
> 会話中に表示される `Token usage: X/Y; Z remaining` を参照
> 例: Claude Codeの場合は予算200,000トークン

### 記録すべき内容を確認
- [ ] 現在のセッションで決定した重要事項を記録したか？
- [ ] 議論の流れと理由を記録したか？
- [ ] 次のセッションで必要な「文脈」「空気感」を言語化したか？
- [ ] 技術的な決定の「なぜ」を明記したか？
- [ ] 注意事項に新しい学びを追加したか？

---

## 🔍 次のセッション開始時の検証プロトコル

**次のAIへ: セッション開始時に必ず以下を実行してください**

### 1. 前セッションの完了状態を検証
下記の「検証コマンド」を実行し、申し送りの「完了」が実態と一致しているか確認してください。

### 2. 検証結果を人間に報告
- ✅ **全て成功**: 「前セッションの完了状態を確認しました。[次のPhase/タスク]から開始します。」
- ⚠️ **失敗あり**: 「[Phase/タスク名]が未完了でした（理由: [エラー内容]）。[該当箇所]から再開します。」

### 3. 実態ベースで進める
- 申し送りの「完了」は参考程度
- 検証結果が真実

---

## 現在の状況（Phase別 / タスク別）

### Phase X: [Phase名 / タスク名]
**ステータス**: ✅ 完了 / ⚠️ 部分完了 / ❌ 未完了

**完了内容**:
- ✅ [実装した機能・修正した内容]
- ✅ [テストした内容]

**未完了内容**:
- ⚠️ [まだテストしていない内容]
- ⚠️ [残っている課題]

**検証コマンド** (次のセッションのAIが実行):
```bash
# 基本的な動作確認
curl http://localhost:3000/api/endpoint

# テストコード（あれば）
npm test -- test-name

# その他の確認コマンド
[コマンド]
```

**検証が失敗した場合の対処**:
- [エラーケース1] が起きたら → [対処方法 / どこから再開]
- [エラーケース2] が起きたら → [対処方法 / どこから再開]

---

## 次にやること
1. 最優先: XXX（理由: ...）
2. 次に: YYY
3. その後: ZZZ

## 注意事項
- ⚠️ XXXは動作しない（理由: ...）
- ⚠️ YYYを変更する場合はZZZも更新必要
- ⚠️ [重要な制約や注意点]

## 技術的な文脈
- 使用技術: [フレームワーク] v[バージョン]
- 重要ファイル: `path/to/file`
- 関連ドキュメント: [リンク]

---

## セッション文脈サマリー

### 核心的な設計決定
- **決定事項**: [何を決めたか]
  - 理由: [なぜその判断をしたか]
  - 影響範囲: [どこに影響するか]

### 議論の流れ
1. **最初の問題認識**: どんな課題から始まったか
2. **検討したアプローチ**: どんな選択肢を考えたか
3. **最終決定**: 何を選び、なぜそれを選んだか
4. **残った課題**: 何が未解決か

### 次のセッションに引き継ぐべき「空気感」
- **このプロジェクトの優先順位**: 何を最も重視しているか
- **避けるべきアンチパターン**: 過去の失敗から学んだこと
- **重視している価値観**: コードの品質、速度、保守性のバランス
- **現在の開発フェーズ**: プロトタイプ/安定化/最適化など

---

## 変更履歴
- YYYY-MM-DD: [変更内容]
- YYYY-MM-DD: [変更内容]

---

**作成日時**: YYYY-MM-DD HH:MM:SS
**作成者**: [名前 or AI]

---

## 📋 申し送り作成完了時の通知例

申し送りを作成したら、ユーザーに以下の形式で通知してください：

```
申し送りファイルを作成しました: docs/letters/YYYY-MM-DD-HH-MM-SS.md

次のClaudeセッションでは、以下のメッセージで開始してください：

---
docs/letters/YYYY-MM-DD-HH-MM-SS.md を日本語で。

このプロジェクトの運用ルール

・知見は docs/notes/ (命名: 連番-{title}.md、作成時 README/TEMPLATE参照) ※注意: ノート作成はセッション終了時の申し送りフロー内でのみ実行すること
・申し送りは docs/letters/ (このファイル、作成時 README/TEMPLATE参照) ※注意: 申し送り作成はユーザーが明示的に指示したときのみ実行すること
・コミット: このリポジトリが公開の場合はClaude痕跡（署名・絵文字）なしで、プライベートの場合はClaude痕跡ありでOK
---
```

**ポイント:**
- `@` でファイルを明示指定することで確実に読み込まれる
- 「日本語で」を含めることで言語設定も明確化
- 運用ルールを毎回伝えることで、プロジェクト固有の規約を継承
