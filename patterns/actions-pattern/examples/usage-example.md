# actionsパターン 使用例

実際のプロジェクトでの actionsパターン の使用例を紹介します。

## 目次

1. [Git操作の例](#git操作の例)
2. [知見まとめの例](#知見まとめの例)
3. [セッション開始の例](#セッション開始の例)
4. [効果の比較](#効果の比較)

---

## Git操作の例

### Before: 会話ベース（非効率）

```
User: "プロジェクトの進捗をコミットして"
```

```
AI: "了解しました。コミットを進めます。

まず現在の変更状況を確認しますね。どのファイルを
コミットに含めますか？すべてのファイルですか、
それとも特定のファイルだけですか？"

[トークン消費: 約2,000]
```

```
User: "全部で"
```

```
AI: "分かりました。すべてのファイルをコミットします。

コミットメッセージはどうしますか？変更内容に応じて
適切なメッセージを提案しましょうか？それとも
ご自身で指定されますか？"

[トークン消費: 約1,800]
```

```
User: "いい感じに書いて"
```

```
AI: "承知しました。変更内容を確認して適切な
コミットメッセージを作成します。

段階的にコミットしますか？それとも一括で
コミットしますか？段階的にすると、履歴が
分かりやすくなります。"

[トークン消費: 約2,000]
```

```
User: "段階的に"
```

```
AI: "分かりました。段階的にコミットします。

[git status実行]
[git diff実行]
[コミット実行]
[プッシュ実行]

完了しました。以下のコミットを作成しました：
- feat: ユーザー認証機能を追加
- fix: エラーハンドリングを改善
- docs: READMEを更新

すべてリモートにプッシュしました。"

[トークン消費: 約2,500]
```

**合計トークン**: 約8,300
**往復回数**: 4回
**所要時間**: 約40-50秒

---

### After: actionsパターン（効率的）

```
User: "@actions/git_commit_and_push.md"
```

```
AI: [ファイル読み込み]
「ではここまで進捗をコミットとプッシュしましょう。
段階的に開発や知見がたまったと思うので、
段階的に状況をコミットしてください。」

[git status実行]
[git diff実行]
[段階的にコミット実行]
[プッシュ実行]

完了しました。以下のコミットを作成しました：
- feat: ユーザー認証機能を追加
- fix: エラーハンドリングを改善
- docs: READMEを更新

すべてリモートにプッシュしました。

[トークン消費: 約1,500]
```

**合計トークン**: 約1,500
**往復回数**: 1回
**所要時間**: 約15-20秒

**削減率**: 82% (トークン)、60% (時間)

---

## 知見まとめの例

### Before: 会話ベース（非効率）

```
User: "この進捗で知見をまとめて"
```

```
AI: "了解しました。知見をまとめます。

どの部分の知見をまとめますか？今回の作業で
特に重要だったポイントを教えてください。"

[トークン消費: 約2,000]
```

```
User: "重要なところ全部"
```

```
AI: "分かりました。では、具体的にはどのような
内容でしょうか？

例えば：
- 技術的な発見
- トラブルシューティング
- ベストプラクティス
- アーキテクチャの決定

どれに該当しますか？"

[トークン消費: 約2,500]
```

```
User: "技術的な発見"
```

```
AI: "承知しました。技術的な発見をまとめます。

ノートに書きますか？それともADR（アーキテクチャ
決定記録）として残しますか？"

[トークン消費: 約2,000]
```

```
User: "ノートで"
```

```
AI: "分かりました。docs/notes/ にノートを作成します。

[コード分析]
[ノート作成]

以下の知見をまとめました：
- 01_user-auth-implementation.md
  （ユーザー認証の実装方法）
- 02_error-handling-pattern.md
  （エラーハンドリングのパターン）

作成完了しました。"

[トークン消費: 約5,500]
```

**合計トークン**: 約12,000
**往復回数**: 4回
**所要時間**: 約60-80秒

---

### After: actionsパターン（効率的）

```
User: "@actions/current_create_knowledge.md"
```

```
AI: [ファイル読み込み]
「ではこの進捗でノートに知見をまとめられそうな
ものをピックアップしてまとめたいです。
まずまとめる計画を教えてください。」

[コード分析]

以下の知見をまとめる計画です：

1. ユーザー認証の実装方法
   - JWT トークンの使用
   - セキュアな保存方法

2. エラーハンドリングのパターン
   - try-catchの適切な配置
   - エラーメッセージの標準化

これらを docs/notes/ にまとめます。
よろしいですか？

[トークン消費: 約2,000]
```

```
User: "OK"
```

```
AI: [ノート作成]

作成完了しました：
- 01_user-auth-implementation.md
- 02_error-handling-pattern.md

[トークン消費: 約2,000]
```

**合計トークン**: 約4,000
**往復回数**: 2回
**所要時間**: 約25-30秒

**削減率**: 67% (トークン)、58% (時間)

---

## セッション開始の例

### Before: 会話ベース（非効率）

```
User: "最新の申し送りを見て作業開始して"
```

```
AI: "了解しました。

申し送りはどこにありますか？docs/letter/
ディレクトリを確認すればよいでしょうか？"

[トークン消費: 約2,000]
```

```
User: "そう"
```

```
AI: [ファイル検索]
[ファイル読み込み]

最新の申し送りを確認しました（2025-10-24の内容）。

次にやることは：
1. ユーザー認証機能のテスト
2. エラーハンドリングの改善

これらに取り掛かりますか？それとも他の作業が
ありますか？"

[トークン消費: 約3,000]
```

```
User: "申し送りの通りに"
```

```
AI: "分かりました。では申し送りの通りに進めます。

プロジェクトの起動方法やテスト手法は把握して
いますか？確認が必要でしたら、ノートを
検索しましょうか？"

[トークン消費: 約2,000]
```

```
User: "確認して"
```

```
AI: [ノート検索]
[ノート読み込み]

起動方法とテスト手法を確認しました：
- 起動: npm run dev
- テスト: npm test

では作業を開始します。"

[トークン消費: 約1,500]
```

**合計トークン**: 約8,500
**往復回数**: 5回
**所要時間**: 約50-60秒

---

### After: actionsパターン（効率的）

```
User: "@actions/simple_start_from_latest_letter.md"
```

```
AI: [ファイル読み込み]
「このセッションを申し送りからスタートします。
最新の申し送りファイルをまず探してから内容を見て
ください。また、申し送りを見たら、ノートの中から、
本プロジェクトでの基本的な起動方法（おそらく
スクリプト起動で縛るやり方）や、本プロジェクトでの
基本的なテスト手法を探して把握してから
スタートしましょう。」

[申し送り検索]
[申し送り読み込み]
[ノート検索]
[起動方法・テスト手法確認]

セッション開始準備完了：

📋 申し送り（2025-10-24）:
- 完了: ユーザー認証の基本実装
- 進行中: エラーハンドリングの改善
- 次: テストの実行と修正

🚀 起動方法: npm run dev
🧪 テスト手法: npm test

次のタスク「ユーザー認証機能のテスト」から
始めますか？

[トークン消費: 約2,500]
```

**合計トークン**: 約2,500
**往復回数**: 1回
**所要時間**: 約20-25秒

**削減率**: 71% (トークン)、58% (時間)

---

## 効果の比較

### トークン消費の比較

| タスク | 会話ベース | actions | 削減数 | 削減率 |
|--------|-----------|---------|--------|--------|
| Git操作 | 8,300 | 1,500 | 6,800 | 82% |
| 知見まとめ | 12,000 | 4,000 | 8,000 | 67% |
| セッション開始 | 8,500 | 2,500 | 6,000 | 71% |
| **平均** | **9,600** | **2,667** | **6,933** | **72%** |

### 時間の比較

| タスク | 会話ベース | actions | 削減時間 | 削減率 |
|--------|-----------|---------|----------|--------|
| Git操作 | 45秒 | 18秒 | 27秒 | 60% |
| 知見まとめ | 70秒 | 28秒 | 42秒 | 58% |
| セッション開始 | 55秒 | 23秒 | 32秒 | 58% |
| **平均** | **57秒** | **23秒** | **34秒** | **59%** |

### 往復回数の比較

| タスク | 会話ベース | actions | 削減回数 |
|--------|-----------|---------|----------|
| Git操作 | 4回 | 1回 | 3回 |
| 知見まとめ | 4回 | 2回 | 2回 |
| セッション開始 | 5回 | 1回 | 4回 |
| **平均** | **4.3回** | **1.3回** | **3回** |

### 累積効果（1ヶ月 = 30日 × 3タスク/日 = 90回）

#### トークン消費

| 方式 | 1回あたり | 90回の合計 | 月間削減 |
|------|----------|-----------|---------|
| 会話ベース | 9,600 | 864,000 | - |
| actions | 2,667 | 240,000 | **624,000** |

**月間削減率**: 72%

#### 時間

| 方式 | 1回あたり | 90回の合計 | 月間削減 |
|------|----------|-----------|---------|
| 会話ベース | 57秒 | 85.5分 | - |
| actions | 23秒 | 34.5分 | **51分** |

**月間削減率**: 60%

---

## 実践のヒント

### 1. 小さく始める

最初は以下の3つから：
- `git_commit_and_push.md`
- `session_start.md`
- `create_note.md`

### 2. 効果を測定

- Claude Code のトークンカウンターで確認
- 時間を記録して比較
- 削減率を計算

### 3. 改善を繰り返す

- 使いながら指示書を改善
- より具体的な手順に変更
- 期待する結果を明確化

### 4. チームで共有

- `actions/` ディレクトリをGit管理
- 効果をチームに報告
- ベストプラクティスを標準化

---

## まとめ

actionsパターンを使うことで：

✅ **トークン消費を約70%削減**
✅ **作業時間を約60%短縮**
✅ **確認の往復を75%削減**（平均4.3回 → 1.3回）
✅ **一貫性のある品質**
✅ **チーム全体で共有可能**

繰り返しタスクが多いプロジェクトほど、効果が大きくなります。

---

**作成日**: 2025-10-25
**バージョン**: 1.0.0
