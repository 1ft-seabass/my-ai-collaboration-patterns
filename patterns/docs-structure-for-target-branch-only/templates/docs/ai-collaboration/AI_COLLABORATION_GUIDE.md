# AI協働開発ガイド（ワンショット版） v1.3.0

> このドキュメントは、AIと効率的に協働開発するための最小限のルールをまとめたものです。
> Claude Code等のAIツールに読み込ませて使用してください。

**最終更新**: 2025-10-19
**バージョン**: 1.3.0（ワンショット版 + テンプレート使用例）

## 基本原則

1. **AIファースト設計** - AIが読みやすい構造
2. **汎用性重視** - 他プロジェクトでも使える
3. **段階的改善** - 完璧を目指さず、まず動く形を作る
4. **メタルールの最小化** - ルールを増やしすぎない

---

## 1. ドキュメント戦略

### なぜ分けるのか
単一の巨大ドキュメントでは、AIが必要な情報を見つけにくく、更新影響も大きい。

### 分類の3軸
1. **対象者** - エンドユーザー / 開発者 / AI
2. **変更頻度** - 低（設計）/ 中（ガイド）/ 高（申し送り）
3. **粒度** - 全体像 → カテゴリ → 個別知見

### エントリーポイント設計
```
docs/README.md（全体像）
  ↓
カテゴリREADME（development/README.md）
  ↓
個別ドキュメント（01_xxx.md）
```

**重要**: すべてのディレクトリにREADME.mdを配置

---

## 2. 知見管理

### 小分けの原則
- **1ファイル = 1知見**（50-150行が目安）
- **独立性を保つ**（単独で理解可能）
- **MECE原則**（漏れなく、重複なく）

### ファイル命名規則
```
<番号>_<タイトル>.md

例:
01_version-management.md
02_major-rules.md
```

### カテゴリ分け
```
best-practices/
├── [機能A]/    # 例: agent, tool, ui
├── [機能B]/
└── workflow/   # 開発ワークフロー
```

**カテゴリ数**: 4〜7個が理想

### テンプレート構造
```markdown
# タイトル
## なぜ必要か
### 問題
### 解決策
## 実装方法
## メリット
## 関連ドキュメント
```

---

## 3. 申し送りメカニズム

### 目的
セッション間で文脈を失わないための引き継ぎ

### 基本構造
```markdown
# 申し送り（YYYY-MM-DD HH:MM:SS）
## 現在の状況
- 完了: [✓] タスク1
- 進行中: [ ] タスク2（どこまで完了）
- 未着手: [ ] タスク3

## 次にやること
1. 最優先: XXX（理由: ...）
2. 次に: YYY

## 注意事項
- ⚠️ XXXは動作しない（理由: ...）
- ⚠️ YYYを変更する場合はZZZも更新必要

## 技術的な文脈
- 使用技術: [フレームワーク] v[バージョン]
- 重要ファイル: `path/to/file`
- 関連ドキュメント: [リンク]
```

### 配置場所
```
docs/letters/
└── YYYY-MM-DD-HH-MM-SS.md
```

### 書き方のコツ
- ❌ 曖昧: "改善中"
- ✅ 具体的: "v1.4.0まで実装完了、ToDo分類機能追加済み"

### 読むタイミング
- **セッション開始時**（必須）
- **判断に迷った時**（推奨）

---

## 4. AI可読構造設計

### 階層を浅く保つ
- ❌ 深すぎる: `docs/tech/dev/backend/api/v1/agents/task/`
- ✅ 適切: `docs/architecture/agents.md`

**ルール**: 3〜4層まで

### 命名規則の統一
```
✅ task-agent.ts          # kebab-case
✅ 01_version-mgmt.md     # 連番 + kebab-case

❌ TaskAgent.ts           # PascalCase
❌ task_agent.ts          # snake_case
```

### 関連ファイルを近接配置
```
src/[プロジェクト]/
├── agents/
├── tools/
└── templates/

docs/development/
└── best-practices/
    ├── agent/
    └── tool/
```

### README.mdの必須項目
```markdown
# プロジェクト/カテゴリ名

## 概要
（1-2文で目的を説明）

## ファイル一覧
1. [ファイル1](./01_xxx.md) - 説明
2. [ファイル2](./02_xxx.md) - 説明

## クイックリファレンス
（よく使うコマンド、コード例）
```

### AIが探しやすくするコツ
1. **キーワードを明記**: 固有名詞、ファイルパス、技術用語
2. **例を必ず入れる**: コード例、コマンド例
3. **長文には目次**: アウトライン活用

---

## 5. 開発ノートとADR

### ドキュメントの使い分け

| 種類 | 目的 | いつ使う | 配置 |
|------|------|----------|------|
| **開発ノート** | 試行錯誤の記録 | 難しい問題を解決した、技術的発見があった | `docs/notes/XXXX_タイトル.md` |
| **ADR** | 意思決定記録 | 重要なアーキテクチャ選択をした | `docs/architecture/decisions/XXXX-タイトル.md` |
| **申し送り** | セッション引き継ぎ | セッション終了時 | `docs/letters/YYYY-MM-DD-HH-MM-SS.md` |

### 開発ノート（試行錯誤の記録）

#### いつ使う
```
✅ 難しい問題を解決した
✅ 複数の方法を試行錯誤した
✅ 技術的発見があった
✅ 将来同じ問題に遭遇する可能性がある
```

#### 構造
```markdown
# タイトル - 開発記録

## 問題
何が問題だったか

## 試行錯誤
### アプローチA
試したこと → 結果（失敗）

### アプローチB
試したこと → 結果（失敗）

### アプローチC（成功）
試したこと → 結果（成功）

## 解決策
最終的な実装

## 学び
この経験から得た知見
```

### ADR（Architecture Decision Records）

#### いつ使う
```
✅ アーキテクチャ上の重要な選択
✅ 複数の選択肢があり議論した
✅ トレードオフを伴う決定
✅ 将来「なぜ？」と疑問に思いそうな決定
```

#### 構造
```markdown
# ADR-XXXX: タイトル

**Status**: Accepted
**Date**: YYYY-MM-DD

## 背景
どんな状況で何が問題だったのか

## 選択肢
1. 選択肢A - メリット/デメリット（却下理由）
2. 選択肢B - メリット/デメリット（採用理由）
3. 選択肢C - メリット/デメリット（却下理由）

## 決定
何を決めたのか

## 理由
なぜその決定をしたのか

## トレードオフ
良い影響 / 悪い影響
```

---

## 6. ルール追加のルール

### 追加すべきケース
```
✅ 3回以上同じ判断をした
✅ 重要な意思決定をした
✅ トラブル回避方法が分かった
✅ 効率化パターンを発見
```

### 追加不要なケース
```
❌ 1回しか使わない手順
❌ プロジェクト固有すぎる
❌ 既存ルールでカバー済み
❌ 自明すぎる内容
```

### チェックリスト
- [ ] 3回以上使う知見か？
- [ ] 既存ルールでカバーされていないか？
- [ ] 適切なカテゴリを選んだか？
- [ ] ファイル名は分かりやすいか？
- [ ] README を更新したか？
- [ ] 矛盾する既存ルールがないか確認したか？

---

## 推奨ディレクトリ構造

```
project-root/
├── README.md                      # プロジェクト概要
├── docs/
│   ├── README.md                  # ドキュメント目次
│   ├── ai-collaboration/          # AI開発環境（汎用）
│   │   ├── README.md
│   │   └── このファイル.md        # ワンショットガイド
│   ├── development/               # 開発ガイド（プロジェクト固有）
│   │   ├── README.md
│   │   └── best-practices/
│   │       ├── README.md
│   │       ├── [機能A]/
│   │       ├── [機能B]/
│   │       └── workflow/
│   ├── architecture/              # アーキテクチャ設計
│   │   ├── README.md
│   │   └── decisions/             # ADR（意思決定記録）
│   ├── notes/                     # 開発ノート（試行錯誤の記録）
│   ├── spec/                      # 仕様書
│   └── letters/                    # 申し送り（時系列）
├── src/                           # ソースコード
└── tests/                         # テストコード
```

---

## クイックスタート

### 新プロジェクトへの適用

1. **ディレクトリ作成**
```bash
mkdir -p docs/{development/best-practices,ai-collaboration,letters,architecture/decisions,notes,spec}
```

2. **このファイルを配置**
```bash
# このワンショットガイドを配置
cp AI_COLLABORATION_GUIDE.md docs/ai-collaboration/
```

3. **README作成**
```bash
# 各ディレクトリにREADME.mdを作成
touch docs/README.md
touch docs/development/README.md
touch docs/development/best-practices/README.md
```

4. **AIに読ませる**
```
セッション開始時:
「docs/ai-collaboration/AI_COLLABORATION_GUIDE.md を読んで、
このプロジェクトの開発スタイルを理解してください」
```

---

## 運用のコツ

### セッション開始時
1. 最新の申し送りを確認
2. 必要に応じてこのガイドを参照
3. ルールに従って作業

### セッション終了時
1. 申し送りを作成（テンプレート使用）
2. 重要な知見があれば記録を検討

### ルール追加時
1. チェックリストで確認
2. 適切な場所に配置
3. README更新

### 迷ったら
- **ドキュメント分割**: 迷ったら分ける
- **ルール追加**: 3回使ったら追加

---

## よくある質問

**Q: ファイルサイズの目安は？**
A: 50-150行。150行超えたら分割を検討。

**Q: カテゴリが増えすぎたら？**
A: 4-7個が理想。それ以上なら統合を検討。

**Q: 申し送りはいつ書く？**
A: セッション終了時（必須）、大きな変更後（推奨）。

**Q: テンプレートは必須？**
A: 推奨。構造が統一され、AIが読みやすくなる。

**Q: 既存ルールと矛盾したら？**
A: 既存ルールを更新し、新旧を明記。

---

## このガイドの使い方

### 開発者として
- プロジェクト開始時に一読
- ルール追加時に参照
- 必要に応じてカスタマイズ

### AIアシスタントとして
- セッション開始時に読み込み
- ルールに従って動作
- 判断に迷ったら参照

---

**最終更新**: 2025-10-19
**バージョン**: 1.3.0（ワンショット版 + テンプレート使用例）
